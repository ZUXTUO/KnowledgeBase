# Windows端口转发工具

一个基于C#开发的图形界面工具，用于管理Windows系统的端口转发规则。该工具通过调用`netsh interface portproxy`命令来实现端口转发功能。

## 功能特性

- **图形化界面**：直观的GUI界面，方便管理端口转发规则
- **端口转发管理**：支持添加、删除和查看端口转发规则
- **IPv4转发**：支持IPv4到IPv4的端口转发（v4tov4）
- **实时状态显示**：显示当前系统中的所有端口转发规则
- **命令显示**：实时显示执行的netsh命令
- **自动IP检测**：自动检测本地IP地址并填入表单

## 使用方法

1. **以管理员身份运行**：由于端口转发需要系统权限，必须以管理员身份运行程序
2. **查看现有规则**：启动程序后会自动列出当前系统的端口转发规则
3. **添加端口转发**：
   - 点击工具栏上的"添加"按钮
   - 在弹出的对话框中填写源IP地址、源端口、目标IP地址和目标端口
   - 点击确定以创建转发规则
4. **删除端口转发**：
   - 点击工具栏上的"删除"按钮
   - 在弹出的对话框中填写要删除的源IP地址和源端口
   - 点击确定以删除转发规则
5. **刷新规则列表**：点击工具栏上的"刷新"按钮更新规则列表

## 技术细节

- **开发语言**：C# .NET Framework 3.5
- **界面框架**：Windows Forms
- **底层技术**：通过调用cmd.exe执行netsh命令
- **权限要求**：需要管理员权限

## 支持的netsh命令

- `netsh interface portproxy show all` - 显示所有端口转发规则
- `netsh interface portproxy add v4tov4` - 添加IPv4到IPv4的端口转发规则
- `netsh interface portproxy delete v4tov4` - 删除IPv4到IPv4的端口转发规则

## 注意事项

- 程序需要管理员权限才能正常工作
- 端口转发规则在系统重启后会丢失（除非使用了持久化配置）
- 需要防火墙允许相应端口的流量
- 请确保指定的端口没有被其他服务占用

## 应用场景

- 本地开发环境的端口映射
- 网络调试和测试
- 服务器端口转发
- 穿透防火墙限制

## 原始项目

基于：https://github.com/OceanAirdrop/Windows-Port-Forwarder